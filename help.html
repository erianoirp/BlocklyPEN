<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>BlocklyPENの使い方</title>
  <script src="./blockly/blockly_compressed.js"></script>
  <script src="./blocks/file.js"></script>
  <script src="./blocks/function.js"></script>
  <script src="./blocks/gdraw.js"></script>
  <script src="./blocks/gset.js"></script>
  <script src="./blocks/gwindow.js"></script>
  <script src="./blocks/inoutput.js"></script>
  <script src="./blocks/logic.js"></script>
  <script src="./blocks/loop.js"></script>
  <script src="./blocks/math.js"></script>
  <script src="./blocks/num.js"></script>
  <script src="./blocks/str.js"></script>
  <script src="./blocks/start.js"></script>
  <script src="./blocks/value.js"></script>
  <script src="./blocks/variable.js"></script>
  <link href="./help.css" type="text/css" rel="stylesheet"/>
  <script type="text/javascript">
function embedBlock(_block) {
  const div = _block + 'Div';
  const xml = _block + 'Xml';
  let workspace = Blockly.inject(div, 
    {grid: {spacing: 25, length: 3, colour: '#ccc', snap: false}}
  );
  Blockly.Xml.domToWorkspace(document.getElementById(xml), workspace);
}
  </script>
</head>
<body>
  <header>
    BlocklyPEN
  </header>
  <div id="mainContent">
    <h1>BlocklyPENの使い方</h1>
    <article>
      <h2>BlocklyPENとは</h2>
      <p>
BlocklyPENとは、名古屋高等学校で教師をしていらっしゃる「中西 渉 (なかにし わたる)」先生が
作成している「<a href="https://watayan.net/index.html">WaPEN</a>」と、Googleが提供しているライブラリ
「<a href="https://developers.google.com/blockly/">Blockly</a>」を組み合わせた、センター試験用手順記述標準言語(DNCL)の勉強用教材です。
      </p>
      <p>
BlocklyPENでは、ブロックを組み合わせてプログラミングを行うことができます。これは、
「文字入力の手間が減り、誤字や脱字を減らすことができる」、
「ブロックが色分けされており、構文の種類や位置関係を明確にすることができる」
といった、ブロックプログラミングならではのメリットをもたらします。
      </p>
    </article>
    <article>
      <h2>基本的な使い方</h2>
    </article>
    <article>
      <h2>ブロックの種類</h2>
      <section>
        <h3>変数</h3>
        <!-- 変数宣言ブロック -->
        <section class="blockSection">
          <div id="declareVariableDiv" class="sampleBlock"></div>
          <xml id="declareVariableXml" style="display: none">
            <block type="declare_variable" x="3"></block>
          </xml>
          <script>embedBlock('declareVariable');</script>
<!--
          <script>
  {
    /* ブロックの幅が取得できない てかgetElementsByClassNameでブロックが取得できない
    let div = document.getElementById('declareBlockDiv');
    //let block = div.getElementsByClassName('blocklyDraggable');
    let blocks = document.getElementsByClassName('blocklyDraggable');
    console.log(`blocks.length: ${blocks.length}`);
    console.log(`w: ${blocks[1].style.width}, h: ${blocks[1].style.height}`);
    //let test = block.getBBox();
    //console.log(`x: ${test.width}, y: ${test.y}`);
    let startX = (div.clientWidth - block.clientWidth) / 2;
    let startY = (div.clientHeight - block.clientHeight) / 2;
    let translate = 'translate(' + startX + ',' + startY + ')';
    //block.style.transform = translate;
    */
    let workspace = Blockly.inject('declareVariableDiv', 
      {grid: {spacing: 25, length: 3, colour: '#ccc', snap: false}}
    );
    Blockly.Xml.domToWorkspace(document.getElementById('declareVariableXml'), workspace);
  }
          </script>
-->
          <div class="blockDescription">
<h4>変数宣言ブロック</h4>
<p>変数を宣言する。<br>
プルダウンメニューから宣言する変数の型を指定し、「変数ブロック」に書かれた名前の変数を宣言する。</p>
        </div>
        </section>
        <!-- 代入ブロック -->
        <section class="blockSection">
          <div id="assignDiv" class="sampleBlock"></div>
          <xml id="assignXml" style="display: none">
            <block type="assign"></block>
          </xml>
          <script>embedBlock('assign');</script>
          <div class="blockDescription">
<h4>代入ブロック</h4>
<p>変数に値を代入する。<br>
左辺に変数ブロックを置き、右辺に変数ブロックや値ブロックを置くことで、
左辺の変数に右辺値を代入することができる。<br>
左辺には変数ブロックしか置くことができない。</p>
          </div>
        </section>
        <!-- 変数ブロック -->
        <section class="blockSection">
          <div id="variableDiv" class="sampleBlock"></div>
          <xml id="variableXml" style="display: none">
            <block type="variable"></block>
          </xml>
          <script>embedBlock('variable');</script>
          <div class="blockDescription">
<h4>変数ブロック</h4>
<p>変数を参照する。<br>
プルダウンメニューをクリックすることで、「既存の変数を選択」、「選択中の変数名を変更」、
「選択中の変数を削除」することができる。<br>
「選択中の変数を削除」すると、エディタ上にある同名の変数ブロックも削除される。<br>
2つ以上エディタに存在の変数ブロックのうちの1つを削除したい場合（変数を削除するのではなく
ブロックを削除したい場合）は、右クリックからブロックを削除する。</p>
          </div>
        </section>
      </section>
      <!-- 値 -->
      <section>
        <h3>値</h3>
        <!-- 整数ブロック -->
        <section class="blockSection">
          <div id="integerDiv" class="sampleBlock"></div>
          <xml id="integerXml" style="display: none">
            <block type="integer"></block>
          </xml>
          <script>embedBlock('integer');</script>
          <div class="blockDescription">
<h4>整数ブロック</h4>
<p>整数値をを入力する。<br>
整数型の変数に代入したり計算に使用する。<br>
-9007199254740991～9007199254740991までの値を扱える。</p>
          </div>
        </section>
        <!-- ~整数ブロック -->
        <!-- 実数ブロック -->
        <section class="blockSection">
          <div id="floatDiv" class="sampleBlock"></div>
          <xml id="floatXml" style="display: none">
            <block type="float"></block>
          </xml>
          <script>embedBlock('float');</script>
          <div class="blockDescription">
<h4>実数ブロック</h4>
<p>実数値を入力する。<br>
実数型の変数に代入したり計算に使用する。<br>
整数部分を入力した後にTabキーを押下すると、マウスを使わずに
カーソルを小数部分を移動できる。小数部分から整数部分にカーソルを
移動させるには、Shiftキーを押下しながらTabキーを押下する。</p>
<!-- Number.NEGATIVE_INFINITY～Number.POSITIVE_INFINITYまでの値を扱える。-->
          </div>
        </section>
        <!-- ~実数ブロック -->
        <!-- 文字列ブロック -->
        <section class="blockSection">
          <div id="stringDiv" class="sampleBlock"></div>
          <xml id="stringXml" style="display: none">
            <block type="string"></block>
          </xml>
          <script>embedBlock('string');</script>
          <div class="blockDescription">
<h4>文字列ブロック</h4>
<p>文字列値をを入力する。<br>
文字列型の変数に代入したり文字列を表示するために使用する。</p>
          </div>
        </section>
        <!-- ~文字列ブロック -->
        <!-- 真偽ブロック -->
        <section class="blockSection">
          <div id="booleanDiv" class="sampleBlock"></div>
          <xml id="booleanXml" style="display: none">
            <block type="boolean"></block>
          </xml>
          <script>embedBlock('boolean');</script>
          <div class="blockDescription">
<h4>真偽ブロック</h4>
<p>真偽値をを入力する。<br>
真偽型の変数に代入したり真偽を判定するために使用する。</p>
          </div>
        </section>
        <!-- ~真偽ブロック -->
      </section>
      <!-- 計算 -->
      <section>
        <h3>計算</h3>
        <section class="blockSection">
          <div id="calculationDiv" class="sampleBlock"></div>
          <xml id="calculationXml" style="display: none">
            <block type="calculation"></block>
          </xml>
          <script>embedBlock('calculation');</script>
          <div class="blockDescription">
<h4>演算ブロック</h4>
<p>「＋」「－」「×」「÷」「％」の演算を行う。<br>。
プルダウンメニューから演算子を指定し、演算子の左右のブロックの演算を行う。<br>
演算結果を代入ブロックの右辺として利用したり、演算ブロックの中に演算ブロックを入れて
利用する（入れ子）。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="randomDiv" class="sampleBlock"></div>
          <xml id="randomXml" style="display: none">
            <block type="random"></block>
          </xml>
          <script>embedBlock('random');</script>
          <div class="blockDescription">
<h4>ランダムブロック</h4>
<p>ランダムな数値を取得するためのブロック。<p>
          </div>
        </section>
      </section>
      <section>
        <h3>入出力</h3>
        <!-- 入力ブロック -->
        <section class="blockSection">
          <div id="inputDiv" class="sampleBlock"></div>
          <xml id="inputXml" style="display: none">
            <block type="input"></block>
          </xml>
          <script>embedBlock('input');</script>
          <div class="blockDescription">
<h4>入力ブロック</h4>
<p>キーボードからの値を変数に代入する。<br>
この文が実行されると入力を促すウィンドウが表示され、そこに値を入力することができる。<br>
入力した値はこのブロックに置いた変数ブロックに代入される。<br>
このブロックには変数ブロックしか置くことができない。</p>
          </div>
        </section>
        <!-- 文字列表示ブロック -->
        <section class="blockSection">
          <div id="printStringDiv" class="sampleBlock"></div>
          <xml id="printStringXml" style="display: none">
            <block type="print_string"></block>
          </xml>
          <script>embedBlock('printString');</script>
          <div class="blockDescription">
<h4>文字列表示ブロック</h4>
<p>入力された文字列を表示する。<br>
文字列を入力し、改行の有無を選択して表示する。</p>
          </div>
        </section>
        <!-- 値表示ブロック -->
        <section class="blockSection">
          <div id="printVDiv" class="sampleBlock"></div>
          <xml id="printVXml" style="display: none">
            <block type="print_v"></block>
          </xml>
          <script>embedBlock('printV');</script>
          <div class="blockDescription">
<h4>値表示ブロック</h4>
<p>置かれたブロックの値を表示する。<br>
置かれたブロックの値を改行の有無を選択して表示する。</p>
          </div>
        </section>
      </section>
      <section>
        <h3>条件分岐</h3>
        <section class="blockSection">
          <div id="conditionsDiv" class="sampleBlock"></div>
          <xml id="conditionsXml" style="display: none">
            <block type="conditions"></block>
          </xml>
          <script>embedBlock('conditions');</script>
          <div class="blockDescription">
<h4>比較ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="ifDiv" class="sampleBlock"></div>
          <xml id="ifXml" style="display: none">
            <block type="if"></block>
          </xml>
          <script>embedBlock('if');</script>
          <div class="blockDescription">
<h4>条件ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="ifelseDiv" class="sampleBlock"></div>
          <xml id="ifelseXml" style="display: none">
            <block type="ifelse"></block>
          </xml>
          <script>embedBlock('ifelse');</script>
          <div class="blockDescription">
<h4>二分条件ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
      </section>
      <section>
        <h3>繰り返し</h3>
        <section class="blockSection">
          <div id="whileDiv" class="sampleBlock"></div>
          <xml id="whileXml" style="display: none">
            <block type="while"></block>
          </xml>
          <script>embedBlock('while');</script>
          <div class="blockDescription">
<h4>繰り返しブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="forplusDiv" class="sampleBlock"></div>
          <xml id="forplusXml" style="display: none">
            <block type="forplus"></block>
          </xml>
          <script>embedBlock('forplus');</script>
          <div class="blockDescription">
<h4>インクリメント型繰り返しブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="forminusDiv" class="sampleBlock"></div>
          <xml id="forminusXml" style="display: none">
            <block type="forminus"></block>
          </xml>
          <script>embedBlock('forminus');</script>
          <div class="blockDescription">
<h4>デクリメント型繰り返しブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
      </section>
      <section>
        <h3>窓操作</h3>
        <section class="blockSection">
          <div id="gopenwDiv" class="sampleBlock"></div>
          <xml id="gopenwXml" style="display: none">
            <block type="gopenw"></block>
          </xml>
          <script>embedBlock('gopenw');</script>
          <div class="blockDescription">
<h4>窓表示ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="gclosewDiv" class="sampleBlock"></div>
          <xml id="gclosewXml" style="display: none">
            <block type="gclosew"></block>
          </xml>
          <script>embedBlock('gclosew');</script>
          <div class="blockDescription">
<h4>窓非表示ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="gclearwDiv" class="sampleBlock"></div>
          <xml id="gclearwXml" style="display: none">
            <block type="gclearw"></block>
          </xml>
          <script>embedBlock('gclearw');</script>
          <div class="blockDescription">
<h4>窓クリアブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
      </section>
      <section>
        <h3>描画設定</h3>
        <section class="blockSection">
          <div id="gscolorDiv" class="sampleBlock"></div>
          <xml id="gscolorXml" style="display: none">
            <block type="gscolor"></block>
          </xml>
          <script>embedBlock('gscolor');</script>
          <div class="blockDescription">
<h4>色設定ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="gsstyleDiv" class="sampleBlock"></div>
          <xml id="gsstyleXml" style="display: none">
            <block type="gsstyle"></block>
          </xml>
          <script>embedBlock('gsstyle');</script>
          <div class="blockDescription">
<h4>太さ設定ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
      </section>
      <section>
        <h3>描画</h3>
        <section class="blockSection">
          <div id="gdtextDiv" class="sampleBlock"></div>
          <xml id="gdtextXml" style="display: none">
            <block type="gdtext"></block>
          </xml>
          <script>embedBlock('gdtext');</script>
          <div class="blockDescription">
<h4>文字列描画ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="gdlineDiv" class="sampleBlock"></div>
          <xml id="gdlineXml" style="display: none">
            <block type="gdline"></block>
          </xml>
          <script>embedBlock('gdline');</script>
          <div class="blockDescription">
<h4>線描画ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="gdboxDiv" class="sampleBlock"></div>
          <xml id="gdboxXml" style="display: none">
            <block type="gdbox"></block>
          </xml>
          <script>embedBlock('gdbox');</script>
          <div class="blockDescription">
<h4>矩形描画ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="gfboxDiv" class="sampleBlock"></div>
          <xml id="gfboxXml" style="display: none">
            <block type="gfbox"></block>
          </xml>
          <script>embedBlock('gfbox');</script>
          <div class="blockDescription">
<h4>塗りつぶした矩形描画ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="gdcircleDiv" class="sampleBlock"></div>
          <xml id="gdcircleXml" style="display: none">
            <block type="gdcircle"></block>
          </xml>
          <script>embedBlock('gdcircle');</script>
          <div class="blockDescription">
<h4>円描画ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
        <section class="blockSection">
          <div id="gfcircleDiv" class="sampleBlock"></div>
          <xml id="gfcircleXml" style="display: none">
            <block type="gfcircle"></block>
          </xml>
          <script>embedBlock('gfcircle');</script>
          <div class="blockDescription">
<h4>塗りつぶした円描画ブロック</h4>
<p>ランダムな数値を取得するためのブロック。</p>
          </div>
        </section>
      </section>
      <!-- 関数 -->
      <section>
        <h3>関数</h3>
        <!-- 関数定義ブロック -->
        <section class="blockSection">
          <div id="defineFunctionDiv" class="sampleBlock"></div>
          <xml id="defineFunctionXml" style="display: none">
            <block type="define_function"></block>
          </xml>
          <script>embedBlock('defineFunction');</script>
          <div class="blockDescription">
<h4>関数定義ブロック</h4>
<p>関数を定義する。<br>
プルダウンメニューから戻り値の型を指定し、その右の入力欄に
関数名を指定する。<br>
「(」の右には「引数ブロック」と「閉じ括弧ブロック」を置くことができる。<br>
BlocklyPEN上では「閉じ括弧ブロック」が最初からセットされている。</p>
          </div>
        </section>
        <!-- ~関数定義ブロック -->
        <!-- 手続き定義ブロック -->
        <section class="blockSection">
          <div id="defineStepDiv" class="sampleBlock"></div>
          <xml id="defineStepXml" style="display: none">
            <block type="define_step"></block>
          </xml>
          <script>embedBlock('defineStep');</script>
          <div class="blockDescription">
<h4>手続き定義ブロック</h4>
<p>手続きを定義する。<br>
入力欄に手続き名を指定する。<br>
「(」の右には「引数ブロック」と「閉じ括弧ブロック」を置くことができる。<br>
BlocklyPEN上では「閉じ括弧ブロック」が最初からセットされている。</p>
          </div>
        </section>
        <!-- ~手続き定義ブロック -->
        <!-- 仮引数ブロック -->
        <section class="blockSection">
          <div id="paramDiv" class="sampleBlock"></div>
          <xml id="paramXml" style="display: none">
            <block type="param_block"></block>
          </xml>
          <script>embedBlock('param');</script>
          <div class="blockDescription">
<h4>仮引数ブロック</h4>
<p>関数と手続きの仮引数を定義する。<br>
このブロック自身と「関数定義ブロック」・「手続き定義ブロック」の
仮引数部分にのみ置くことができる。<br>
プルダウンメニューから仮引数の型を指定し、その右の入力欄に
仮引数の名前を指定する。</p>
          </div>
        </section>
        <!-- ~仮引数ブロック -->
        <!-- 返却ブロック -->
        <section class="blockSection">
          <div id="returnDiv" class="sampleBlock"></div>
          <xml id="returnXml" style="display: none">
            <block type="return_block"></block>
          </xml>
          <script>embedBlock('return');</script>
          <div class="blockDescription">
<h4>返却ブロック</h4>
<p>関数の呼び出し元に値を返却する。<br>
「変数ブロック」や「値ブロック」を置き、その値を関数の呼び出し元に
返却する。<br>
関数を定義した場合は必ず1つ以上は使わなけらばならない。</p>
          </div>
        </section>
        <!-- ~返却ブロック -->
        <!-- 脱出ブロック -->
        <section class="blockSection">
          <div id="returnVoidDiv" class="sampleBlock"></div>
          <xml id="returnVoidXml" style="display: none">
            <block type="return_void_block"></block>
          </xml>
          <script>embedBlock('returnVoid');</script>
          <div class="blockDescription">
<h4>脱出ブロック</h4>
<p>手続きを抜ける。<br>
手続きの途中で処理を終了したい場合に使用する。<br>
手続きを定義した場合でも必ず使う必要はない。</p>
          </div>
        </section>
        <!-- ~脱出ブロック -->
        <!-- 手続き呼び出しブロック -->
        <section class="blockSection">
          <div id="callStepDiv" class="sampleBlock"></div>
          <xml id="callStepXml" style="display: none">
            <block type="call_step"></block>
          </xml>
          <script>embedBlock('callStep');</script>
          <div class="blockDescription">
<h4>手続き呼び出しブロック</h4>
<p>手続きを呼ぶ。<br>
入力欄で呼び出す手続きの名前を指定する。<br>
「(」の右には「実引数ブロック」と「閉じ括弧ブロック」を置くことができる。<br>
BlocklyPEN上では「閉じ括弧ブロック」が最初からセットされている。</p>
          </div>
        </section>
        <!-- ~手続き呼び出しブロック -->
        <!-- 関数呼び出しブロック -->
        <section class="blockSection">
          <div id="callFunctionDiv" class="sampleBlock"></div>
          <xml id="callFunctionXml" style="display: none">
            <block type="call_function"></block>
          </xml>
          <script>embedBlock('callFunction');</script>
          <div class="blockDescription">
<h4>関数呼び出しブロック</h4>
<p>関数を呼び出す。<br>
入力欄で呼び出す関数の名前を指定する。<br>
「(」の右には「実引数ブロック」と「閉じ括弧ブロック」を置くことができる。<br>
BlocklyPEN上では「閉じ括弧ブロック」が最初からセットされている。</p>
          </div>
        </section>
        <!-- ~関数呼び出しブロック -->
        <!-- 実引数ブロック -->
        <section class="blockSection">
          <div id="argumentDiv" class="sampleBlock"></div>
          <xml id="argumentXml" style="display: none">
            <block type="argument"></block>
          </xml>
          <script>embedBlock('argument');</script>
          <div class="blockDescription">
<h4>実引数ブロック</h4>
<p>実引数を指定する。<br>
このブロック自身と「閉じ括弧ブロック」のみ接続できる。<br>
「変数ブロック」や「値ブロック」を置き、その値を実引数として扱う。</p>
          </div>
        </section>
        <!-- ~実引数ブロック -->
        <!-- 閉じ括弧ブロック -->
        <section class="blockSection">
          <div id="closeParenthesisDiv" class="sampleBlock"></div>
          <xml id="closeParenthesisXml" style="display: none">
            <block type="close_parenthesis"></block>
          </xml>
          <script>embedBlock('closeParenthesis');</script>
          <div class="blockDescription">
<h4>閉じ括弧ブロック</h4>
<p>関数定義や関数呼び出しなどの括弧を閉じる。<br>
「関数定義ブロック」・「手続き定義ブロック」・「関数呼び出しブロック」・
「手続き呼び出しブロック」・「実引数ブロック」・「仮引数ブロック」に
接続し、括弧を閉じる。<br>
BlocklyPENでは、「関数定義ブロック」などに初めから接続されているため使用する
必要はないが、誤って接続されている「閉じ括弧ブロック」を削除してしまった場合に
使用する。</p>
          </div>
        </section>
        <!-- 閉じ括弧ブロック -->
      </section>
    </article>
  </div>
  <footer>
  </footer>
</body>
</html>
